"use strict";var liS=$(".commodity_ul li"),addS=$(".addShopp");function totall(){function i(){$.ajax({url:"../interface/showlist.php",dataType:"json",success:function(e){$(".cont").remove(),1==e.code&&($.each(e.data,function(e,a){$(".contS").append('<div class="cont clearfix">\n                                <div class="top_1"><input type="checkbox" class="c_a1" value="1" checked></div>\n                                    <div class="top_2"><a href=""><img src="'.concat(a.product_img,'" alt="" data-index="').concat(a.product_id,'"></a></div>\n                                    <div class="top_name">').concat(a.product_name,'</div>\n                                    <div class="price">').concat(a.product_price,'</div>\n                                    <div class="top_num">\n                                    <div class="top_btn">\n                                    <input class="aa" type="button" value="-">\n                                    <input class="cc" type="text" name="wenben" value="').concat(a.product_num,'" readonly>\n                                    <input class="aa" type="button" value="+">\n                                    </div>\n                                    </div>\n                                    <div class="subtotal">\n                                        <p>').concat(parseInt(a.product_price)*a.product_num,'元</p>\n                                        <p>已优惠200元</p>\n                                    </div>\n                                    <div class="clear"><span>X</span></div>\n                             </div>'))}),p(),l())}})}function p(){for(var e=0,a=$(".cont"),n=0;n<a.length;n++){if(a[n].children[0].children[0].checked){var t=parseInt(a[n].children[5].children[0].innerHTML);e+=parseFloat(t)}}$(".f2_hj").html(e)}function l(){$(".f_i1").html($(".c_a1").size()),$(".f_i2").html($(".c_a1:checked").size())}$(".addShopp").click(function(){var e=$(this).parent(),a=e.children().eq(0).attr("src"),n=e.children().eq(1).get(0).innerHTML,t=e.children().eq(2).get(0).innerHTML,c=e.children().attr("data-index");$.ajax({url:"../interface/addwq.php",dataType:"json",data:{id:c,name:n,img:a,price:t,num:"1"},success:function(e){1==e.code?(alert("加入购物车成功"),i()):alert("失败")}})}),i(),$(".main_inner").on("click",".clear",function(e){var a=$(this).parent().children(".top_2").children("a").children("img").attr("data-index");$.ajax({url:"../interface/delwq.php",data:{id:a},dataType:"json",success:function(e){e.code&&(i(),location.href="./shopping.html")}})}),p(),l(),$(".main_inner").on("click",".aa",function(e){if("+"==$(this).val()){var a=$(this).prev().val(),n=parseInt($(this).parent().parent().parent().children().eq(3).html()),t=parseInt(a)+1;$(this).prev().val(t);var c=n*t;$(this).parent().parent().parent().children().eq(5).children().eq(0).html(c+"元");var i=$(this).parent().parent().parent().children(".top_2").children("a").children("img").attr("data-index");$.ajax({url:"../interface/updatewq.php",dataType:"json",data:{type:"add",id:i}})}else if("-"==$(this).val()){var r=$(this).next().val(),d=(n=parseInt($(this).parent().parent().parent().children().eq(3).html()),parseInt(r)-1);c=n*d;if(0==d)return;$(this).next().val(d),$(this).parent().parent().parent().children().eq(5).children().eq(0).html(c+"元");i=$(this).parent().parent().parent().children(".top_2").children("a").children("img").attr("data-index");$.ajax({url:"../interface/updatewq.php",dataType:"json",data:{type:"app",id:i}})}p(),l()}),$(".main_inner").on("click",".a0",function(){1==this.checked?$(".c_a1").prop("checked",!0):$(".c_a1").prop("checked",!1),p(),l()}),$(".c_a1").size()==$(".c_a1:checked").size()&&$(".a0").prop("checked",!0),$(".main_inner").on("click",".c_a1",function(){$(".c_a1").size()==$(".c_a1:checked").size()?$(".a0").prop("checked",!0):$(".a0").prop("checked",!1),$(".f_i1").html($(".c_a1").size()),$(".f_i2").html($(".c_a1:checked").size()),p(),l()}),p(),l()}liS.mouseenter(function(){var e=$(this).index();addS.eq(e).stop().animate({bottom:27})}),liS.mouseleave(function(){var e=$(this).index();addS.eq(e).stop().animate({bottom:-44})}),totall();